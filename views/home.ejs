<% layout('layouts/boilerplate') %>

<style>
  .home-heading {
    font-family: 'Roboto', sans-serif;
    font-weight: 300;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  }

  .home-message {
    font-family: 'Roboto', sans-serif;
    font-style: italic;
    letter-spacing: 1px;
    color: #555;
  }
  
  .song-item {
    margin: 10px 0;
  }
</style>

<input type="text" id="search-input" placeholder="Search Songs">

<div id="search-results">
  <!-- Search results will be appended here -->
</div>

<hr>

<h2>Get Song Recommendations</h2>

<label for="keywords-input">Enter keywords about your program:</label>
<input type="text" id="keywords-input" placeholder="Enter keywords">

<button id="recommend-button">Get Recommendations</button>

<div id="recommend-results">
  <!-- Recommendation results will be appended here -->
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
$(document).ready(function(){
  $('#search-input').on('input', function(e){
    const queryText = e.target.value;
    if (!queryText) {
      $('#search-results').empty();
      return;
    }
    $.ajax({
      url: '/songs/search-solr',
      type: 'GET',
      data: { query: queryText },
      success: function(data){
        $('#search-results').empty();
        data.forEach(function(song){
          $('#search-results').append('<div class="song-item"><a href="/songs/' + song.id + '">' + song.title + '</a></div>');
        });
      },
      error: function(err){
        console.error('Error occurred during search:', err);
      }
    });
  });

  $('#recommend-button').on('click', function(){
    const keywords = $('#keywords-input').val().trim();
    if (!keywords) {
      $('#recommend-results').empty();
      return;
    }
    // Send the keywords to the server for processing and retrieve song recommendations
    $.ajax({
      url: '/songs/search-solr',
      type: 'GET',
      data: { keywords: keywords },
      success: function(data){
        $('#recommend-results').empty();
        data.forEach(function(recommendation){
          $('#recommend-results').append('<div class="song-item">' + recommendation.title + '</div>');
        });
      },
      error: function(err){
        console.error('Error occurred during recommendation:', err);
      }
    });
  });
});
</script>
